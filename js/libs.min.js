!function(e,t){"function"==typeof define&&define.amd?define([],function(){return t()}):"object"==typeof exports?module.exports=t():e.Headhesive=t()}(this,function(){"use strict";var e=function(t,s){for(var n in s)s.hasOwnProperty(n)&&(t[n]="object"==typeof s[n]?e(t[n],s[n]):s[n]);return t},t=function(e,t){var s,n,i,l=Date.now||function(){return(new Date).getTime()},a=null,o=0,r=function(){o=l(),a=null,i=e.apply(s,n),s=n=null};return function(){var c=l(),u=t-(c-o);return s=this,n=arguments,0>=u?(clearTimeout(a),a=null,o=c,i=e.apply(s,n),s=n=null):a||(a=setTimeout(r,u)),i}},s=function(){return void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop},n=function(e,t){for(var s=0,n=e.offsetHeight;e;)s+=e.offsetTop,e=e.offsetParent;return"bottom"===t&&(s+=n),s},i=function(t,s){"querySelector"in document&&"addEventListener"in window&&(this.visible=!1,this.options={offset:300,offsetSide:"top",classes:{clone:"headhesive",stick:"headhesive--stick",unstick:"headhesive--unstick"},throttle:250,onInit:function(){},onStick:function(){},onUnstick:function(){},onDestroy:function(){}},this.elem="string"==typeof t?document.querySelector(t):t,this.options=e(this.options,s),this.init())};return i.prototype={constructor:i,init:function(){if(this.clonedElem=this.elem.cloneNode(!0),this.clonedElem.className+=" "+this.options.classes.clone,document.body.insertBefore(this.clonedElem,document.body.firstChild),"number"==typeof this.options.offset)this.scrollOffset=this.options.offset;else{if("string"!=typeof this.options.offset)throw new Error("Invalid offset: "+this.options.offset);this._setScrollOffset()}this._throttleUpdate=t(this.update.bind(this),this.options.throttle),this._throttleScrollOffset=t(this._setScrollOffset.bind(this),this.options.throttle),window.addEventListener("scroll",this._throttleUpdate,!1),window.addEventListener("resize",this._throttleScrollOffset,!1),this.options.onInit.call(this)},_setScrollOffset:function(){"string"==typeof this.options.offset&&(this.scrollOffset=n(document.querySelector(this.options.offset),this.options.offsetSide))},destroy:function(){document.body.removeChild(this.clonedElem),window.removeEventListener("scroll",this._throttleUpdate),window.removeEventListener("resize",this._throttleScrollOffset),this.options.onDestroy.call(this)},stick:function(){this.visible||(this.clonedElem.className=this.clonedElem.className.replace(new RegExp("(^|\\s)*"+this.options.classes.unstick+"(\\s|$)*","g"),""),this.clonedElem.className+=" "+this.options.classes.stick,this.visible=!0,this.options.onStick.call(this))},unstick:function(){this.visible&&(this.clonedElem.className=this.clonedElem.className.replace(new RegExp("(^|\\s)*"+this.options.classes.stick+"(\\s|$)*","g"),""),this.clonedElem.className+=" "+this.options.classes.unstick,this.visible=!1,this.options.onUnstick.call(this))},update:function(){s()>this.scrollOffset?this.stick():this.unstick()}},i}),function(e,t,s){var n,i,l,a,o,r,c,u,h,f,d,g,p="mPageScroll2id",m="mPS2id",v=".m_PageScroll2id,a[rel~='m_PageScroll2id'],.page-scroll-to-id,a[rel~='page-scroll-to-id'],._ps2id",_={scrollSpeed:1e3,autoScrollSpeed:!0,scrollEasing:"easeInOutQuint",scrollingEasing:"easeOutQuint",pageEndSmoothScroll:!0,layout:"vertical",offset:0,highlightSelector:!1,clickedClass:m+"-clicked",targetClass:m+"-target",highlightClass:m+"-highlight",forceSingleHighlight:!1,keepHighlightUntilNext:!1,highlightByNextTarget:!1,disablePluginBelow:!1,clickEvents:!0,appendHash:!1,onStart:function(){},onComplete:function(){},defaultSelector:!1,live:!0,liveSelector:!1},C=0,S={init:function(r){var r=e.extend(!0,{},_,r);if(e(s).data(m,r),i=e(s).data(m),!this.selector){var c="__"+m;this.each(function(){var t=e(this);t.hasClass(c)||t.addClass(c)}),this.selector="."+c}i.liveSelector&&(this.selector+=","+i.liveSelector),n=n?n+","+this.selector:this.selector,i.defaultSelector&&("object"==typeof e(n)&&0!==e(n).length||(n=v)),i.clickEvents&&e(s).undelegate("."+m).delegate(n,"click."+m,function(t){if(O._isDisabled.call(null))return void O._removeClasses.call(null);var s=e(this),n=s.attr("href"),i=s.prop("href");n&&-1!==n.indexOf("#/")||(O._reset.call(null),f=s.data("ps2id-offset")||0,O._isValid.call(null,n,i)&&O._findTarget.call(null,n)&&(t.preventDefault(),a="selector",o=s,O._setClasses.call(null,!0),O._scrollTo.call(null)))}),e(t).unbind("."+m).bind("scroll."+m+" resize."+m,function(){if(O._isDisabled.call(null))return void O._removeClasses.call(null);var t=e("._"+m+"-t");t.each(function(s){var n=e(this),i=n.attr("id"),l=O._findHighlight.call(null,i);O._setClasses.call(null,!1,n,l),s==t.length-1&&O._extendClasses.call(null)})}),l=!0,O._setup.call(null),O._live.call(null)},scrollTo:function(t,s){if(O._isDisabled.call(null))return void O._removeClasses.call(null);if(t&&void 0!==t){O._isInit.call(null);var n={layout:i.layout,offset:i.offset,clicked:!1},s=e.extend(!0,{},n,s);O._reset.call(null),u=s.layout,h=s.offset,t=-1!==t.indexOf("#")?t:"#"+t,O._isValid.call(null,t)&&O._findTarget.call(null,t)&&(a="scrollTo",o=s.clicked,o&&O._setClasses.call(null,!0),O._scrollTo.call(null))}},destroy:function(){e(t).unbind("."+m),e(s).undelegate("."+m).removeData(m),e("._"+m+"-t").removeData(m),O._removeClasses.call(null,!0)}},O={_isDisabled:function(){var e=t,n="inner",l=i.disablePluginBelow instanceof Array?[i.disablePluginBelow[0]||0,i.disablePluginBelow[1]||0]:[i.disablePluginBelow||0,0];return"innerWidth"in t||(n="client",e=s.documentElement||s.body),e[n+"Width"]<=l[0]||e[n+"Height"]<=l[1]},_isValid:function(e,s){if(e){s=s||e;var n=-1!==s.indexOf("#/")?s.split("#/")[0]:s.split("#")[0],i=t.location.toString().split("#")[0];return"#"!==e&&-1!==e.indexOf("#")&&(""===n||decodeURIComponent(n)===decodeURIComponent(i))}},_setup:function(){var t=O._highlightSelector(),s=1,n=0;return e(t).each(function(){var l=e(this),a=l.attr("href"),o=l.prop("href");if(O._isValid.call(null,a,o)){var r=-1!==a.indexOf("#/")?a.split("#/")[1]:a.split("#")[1],c=e("#"+r);if(c.length>0){i.highlightByNextTarget&&c!==n&&(n?n.data(m,{tn:c}):c.data(m,{tn:"0"}),n=c),c.hasClass("_"+m+"-t")||c.addClass("_"+m+"-t"),c.data(m,{i:s}),l.hasClass("_"+m+"-h")||l.addClass("_"+m+"-h");var u=O._findHighlight.call(null,r);O._setClasses.call(null,!1,c,u),C=s,++s==e(t).length&&O._extendClasses.call(null)}}})},_highlightSelector:function(){return i.highlightSelector&&""!==i.highlightSelector?i.highlightSelector:n},_findTarget:function(t){var s=-1!==t.indexOf("#/")?t.split("#/")[1]:t.split("#")[1],n=e("#"+s);if(n.length<1||"fixed"===n.css("position")){if("top"!==s)return;n=e("body")}return r=n,u||(u=i.layout),h=O._setOffset.call(null),c=[(n.offset().top-h[0]).toString(),(n.offset().left-h[1]).toString()],c[0]=c[0]<0?0:c[0],c[1]=c[1]<0?0:c[1],c},_setOffset:function(){h||(h=i.offset?i.offset:0),f&&(h=f);var t,s,n,l;switch(typeof h){case"object":case"string":t=[h.y?h.y:h,h.x?h.x:h],s=[t[0]instanceof jQuery?t[0]:e(t[0]),t[1]instanceof jQuery?t[1]:e(t[1])],s[0].length>0?(n=s[0].height(),"fixed"===s[0].css("position")&&(n+=s[0][0].offsetTop)):n=!isNaN(parseFloat(t[0]))&&isFinite(t[0])?parseInt(t[0]):0,s[1].length>0?(l=s[1].width(),"fixed"===s[1].css("position")&&(l+=s[1][0].offsetLeft)):l=!isNaN(parseFloat(t[1]))&&isFinite(t[1])?parseInt(t[1]):0;break;case"function":t=h.call(null),t instanceof Array?(n=t[0],l=t[1]):n=l=t;break;default:n=l=parseInt(h)}return[n,l]},_findHighlight:function(s){var n=t.location,i=n.toString().split("#")[0],l=n.pathname;return e("._"+m+"-h[href='#"+s+"'],._"+m+"-h[href='"+i+"#"+s+"'],._"+m+"-h[href='"+l+"#"+s+"'],._"+m+"-h[href='#/"+s+"'],._"+m+"-h[href='"+i+"#/"+s+"'],._"+m+"-h[href='"+l+"#/"+s+"']")},_setClasses:function(t,s,n){var l=i.clickedClass,a=i.targetClass,r=i.highlightClass;t&&l&&""!==l?(e("."+l).removeClass(l),o.addClass(l)):s&&a&&""!==a&&n&&r&&""!==r&&(O._currentTarget.call(null,s)?(s.addClass(a),n.addClass(r)):(!i.keepHighlightUntilNext||e("."+r).length>1)&&(s.removeClass(a),n.removeClass(r)))},_extendClasses:function(){var t=i.targetClass,s=i.highlightClass,n=e("."+t),l=e("."+s),a=t+"-first",o=t+"-last",r=s+"-first",c=s+"-last";e("._"+m+"-t").removeClass(a+" "+o),e("._"+m+"-h").removeClass(r+" "+c),i.forceSingleHighlight?i.keepHighlightUntilNext&&n.length>1?(n.slice(0,1).removeClass(t),l.slice(0,1).removeClass(s)):(n.slice(1).removeClass(t),l.slice(1).removeClass(s)):(n.slice(0,1).addClass(a).end().slice(-1).addClass(o),l.slice(0,1).addClass(r).end().slice(-1).addClass(c))},_removeClasses:function(t){e("."+i.clickedClass).removeClass(i.clickedClass),e("."+i.targetClass).removeClass(i.targetClass+" "+i.targetClass+"-first "+i.targetClass+"-last"),e("."+i.highlightClass).removeClass(i.highlightClass+" "+i.highlightClass+"-first "+i.highlightClass+"-last"),t&&(e("._"+m+"-t").removeClass("_"+m+"-t"),e("._"+m+"-h").removeClass("_"+m+"-h"))},_currentTarget:function(s){var n=i["target_"+s.data(m).i],l=s.data("ps2id-target"),a=l&&e(l)[0]?e(l)[0].getBoundingClientRect():s[0].getBoundingClientRect();if(void 0!==n){var o=s.offset().top,r=s.offset().left,c=n.from?n.from+o:o,u=n.to?n.to+o:o,h=n.fromX?n.fromX+r:r,f=n.toX?n.toX+r:r;return a.top>=u&&a.top<=c&&a.left>=f&&a.left<=h}var d=e(t).height(),g=e(t).width(),p=l?e(l).height():s.height(),v=l?e(l).width():s.width(),_=1+p/d,C=_,S=d>p?_*(d/p):_,O=1+v/g,w=O,y=g>v?O*(g/v):O,I=[a.top<=d/C,a.bottom>=d/S,a.left<=g/w,a.right>=g/y];if(i.highlightByNextTarget){var b=s.data(m).tn;if(b){var k=b[0].getBoundingClientRect();"vertical"===i.layout?I=[a.top<=d/2,k.top>d/2,1,1]:"horizontal"===i.layout&&(I=[1,1,a.left<=g/2,k.left>g/2])}}return I[0]&&I[1]&&I[2]&&I[3]},_scrollTo:function(){g=O._scrollSpeed.call(null),c=i.pageEndSmoothScroll?O._pageEndSmoothScroll.call(null):c;var s=e("html,body"),n=i.autoScrollSpeed?O._autoScrollSpeed.call(null):g,l=s.is(":animated")?i.scrollingEasing:i.scrollEasing,a=e(t).scrollTop(),o=e(t).scrollLeft();switch(u){case"horizontal":o!=c[1]&&(O._callbacks.call(null,"onStart"),s.stop().animate({scrollLeft:c[1]},n,l).promise().then(function(){O._callbacks.call(null,"onComplete")}));break;case"auto":if(a!=c[0]||o!=c[1])if(O._callbacks.call(null,"onStart"),navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/)){var r;s.stop().animate({pageYOffset:c[0],pageXOffset:c[1]},{duration:n,easing:l,step:function(e,s){"pageXOffset"==s.prop?r=e:"pageYOffset"==s.prop&&t.scrollTo(r,e)}}).promise().then(function(){O._callbacks.call(null,"onComplete")})}else s.stop().animate({scrollTop:c[0],scrollLeft:c[1]},n,l).promise().then(function(){O._callbacks.call(null,"onComplete")});break;default:a!=c[0]&&(O._callbacks.call(null,"onStart"),s.stop().animate({scrollTop:c[0]},n,l).promise().then(function(){O._callbacks.call(null,"onComplete")}))}},_pageEndSmoothScroll:function(){var n=e(s).height(),i=e(s).width(),l=e(t).height(),a=e(t).width();return[n-c[0]<l?n-l:c[0],i-c[1]<a?i-a:c[1]]},_scrollSpeed:function(){var t=i.scrollSpeed;return o&&o.length&&o.add(o.parent()).each(function(){var s=e(this);if(s.attr("class")){var n=s.attr("class").split(" ");for(var i in n)if(String(n[i]).match(/^ps2id-speed-\d+$/)){t=n[i].split("ps2id-speed-")[1];break}}}),parseInt(t)},_autoScrollSpeed:function(){var n=e(t).scrollTop(),i=e(t).scrollLeft(),l=e(s).height(),a=e(s).width(),o=[g+g*Math.floor(Math.abs(c[0]-n)/l*100)/100,g+g*Math.floor(Math.abs(c[1]-i)/a*100)/100];return Math.max.apply(Math,o)},_callbacks:function(e){if(i)switch(this[m]={trigger:a,clicked:o,target:r,scrollTo:{y:c[0],x:c[1]}},e){case"onStart":if(i.appendHash&&t.history&&t.history.pushState&&o&&o.length){var s="#"+o.attr("href").split("#")[1];s!==t.location.hash&&history.pushState("","",s)}i.onStart.call(null,this[m]);break;case"onComplete":i.onComplete.call(null,this[m])}},_reset:function(){u=h=f=!1},_isInit:function(){l||S.init.apply(this)},_live:function(){d=setTimeout(function(){i.live?e(O._highlightSelector()).length!==C&&O._setup.call(null):d&&clearTimeout(d),O._live.call(null)},1e3)},_easing:function(){function t(e){var t=7.5625,s=2.75;return 1/s>e?t*e*e:2/s>e?t*(e-=1.5/s)*e+.75:2.5/s>e?t*(e-=2.25/s)*e+.9375:t*(e-=2.625/s)*e+.984375}e.easing.easeInQuad=e.easing.easeInQuad||function(e){return e*e},e.easing.easeOutQuad=e.easing.easeOutQuad||function(e){return 1-(1-e)*(1-e)},e.easing.easeInOutQuad=e.easing.easeInOutQuad||function(e){return.5>e?2*e*e:1-Math.pow(-2*e+2,2)/2},e.easing.easeInCubic=e.easing.easeInCubic||function(e){return e*e*e},e.easing.easeOutCubic=e.easing.easeOutCubic||function(e){return 1-Math.pow(1-e,3)},e.easing.easeInOutCubic=e.easing.easeInOutCubic||function(e){return.5>e?4*e*e*e:1-Math.pow(-2*e+2,3)/2},e.easing.easeInQuart=e.easing.easeInQuart||function(e){return e*e*e*e},e.easing.easeOutQuart=e.easing.easeOutQuart||function(e){return 1-Math.pow(1-e,4)},e.easing.easeInOutQuart=e.easing.easeInOutQuart||function(e){return.5>e?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2},e.easing.easeInQuint=e.easing.easeInQuint||function(e){return e*e*e*e*e},e.easing.easeOutQuint=e.easing.easeOutQuint||function(e){return 1-Math.pow(1-e,5)},e.easing.easeInOutQuint=e.easing.easeInOutQuint||function(e){return.5>e?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2},e.easing.easeInExpo=e.easing.easeInExpo||function(e){return 0===e?0:Math.pow(2,10*e-10)},e.easing.easeOutExpo=e.easing.easeOutExpo||function(e){return 1===e?1:1-Math.pow(2,-10*e)},e.easing.easeInOutExpo=e.easing.easeInOutExpo||function(e){return 0===e?0:1===e?1:.5>e?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2},e.easing.easeInSine=e.easing.easeInSine||function(e){return 1-Math.cos(e*Math.PI/2)},e.easing.easeOutSine=e.easing.easeOutSine||function(e){return Math.sin(e*Math.PI/2)},e.easing.easeInOutSine=e.easing.easeInOutSine||function(e){return-(Math.cos(Math.PI*e)-1)/2},e.easing.easeInCirc=e.easing.easeInCirc||function(e){return 1-Math.sqrt(1-Math.pow(e,2))},e.easing.easeOutCirc=e.easing.easeOutCirc||function(e){return Math.sqrt(1-Math.pow(e-1,2))},e.easing.easeInOutCirc=e.easing.easeInOutCirc||function(e){return.5>e?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2},e.easing.easeInElastic=e.easing.easeInElastic||function(e){return 0===e?0:1===e?1:-Math.pow(2,10*e-10)*Math.sin((10*e-10.75)*(2*Math.PI/3))},e.easing.easeOutElastic=e.easing.easeOutElastic||function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*(2*Math.PI/3))+1},e.easing.easeInOutElastic=e.easing.easeInOutElastic||function(e){return 0===e?0:1===e?1:.5>e?-Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*(2*Math.PI/4.5))/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*(2*Math.PI/4.5))/2+1},e.easing.easeInBack=e.easing.easeInBack||function(e){return 2.70158*e*e*e-1.70158*e*e},e.easing.easeOutBack=e.easing.easeOutBack||function(e){return 1+2.70158*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2)},e.easing.easeInOutBack=e.easing.easeInOutBack||function(e){return.5>e?Math.pow(2*e,2)*(7.189819*e-2.5949095)/2:(Math.pow(2*e-2,2)*(3.5949095*(2*e-2)+2.5949095)+2)/2},e.easing.easeInBounce=e.easing.easeInBounce||function(e){return 1-t(1-e)},e.easing.easeOutBounce=e.easing.easeOutBounce||t,e.easing.easeInOutBounce=e.easing.easeInOutBounce||function(e){return.5>e?(1-t(1-2*e))/2:(1+t(2*e-1))/2}}};O._easing.call(),e.fn[p]=function(t){return S[t]?S[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):S.init.apply(this,arguments)},e[p]=function(t){return S[t]?S[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):S.init.apply(this,arguments)},e[p].defaults=_}(jQuery,window,document);